import{f as W,C as X,q as m,D as Y,E as Z,J as ee,K as N,c as A,a as t,b as r,w as p,G as D,i as l,L as te,M,H as ae,e as se,o as z,d as k,t as C,N as le,O as oe,Q as ne,R as re,S as ie,_ as ue}from"./BAx2i1UF.js";import{_ as de}from"./BXO7cnFK.js";import{_ as ce}from"./D5gPA9cw.js";import{_ as me,u as L,w as pe}from"./Dg_J0kao.js";import{_ as ve}from"./CDlhA1dI.js";const fe={class:"px-0.5 py-2"},_e={class:"flex justify-between items-center mb-6"},he={class:"space-x-2"},ge={class:"mb-4 flex flex-col gap-3"},we={class:"flex flex-col sm:flex-row gap-2 items-end"},xe={class:"flex gap-2 items-center"},be={class:"flex flex-col"},ke={class:"flex flex-col"},ye={class:"flex flex-col"},Ce={class:"flex gap-2"},Se={class:"flex justify-start"},Ae={key:0,class:"overflow-x-auto"},De={class:"w-full text-left"},Me={class:"p-2"},ze={class:"p-2"},Ue={class:"p-2"},Ee={class:"p-2"},$e={class:"p-2 space-x-2"},Ve={key:1,class:"p-4 text-center"},Be={class:"flex flex-wrap justify-between items-center gap-2"},Ne={class:"text-sm"},Le={class:"flex items-center space-x-2"},Fe={class:"flex items-center space-x-1"},je=["max"],He=W({__name:"index",setup(Ie){const F=X(),d=m(1),U=m(1),E=m([]),i=m({has_next:!1,has_prev:!1,page:1,page_size:7,total_count:0,total_pages:1}),v=m(""),f=m(""),_=m(""),S=m(null),j=Z(),g=Y(),$=j.public.API_BASE_URL,h=m(null),w=m(!0),x=m(!0),b=m(!0),H=()=>{w.value=!w.value},I=()=>{x.value=!x.value},P=()=>{b.value=!b.value},G=a=>{!a||a<1||a>i.value.total_pages||(d.value=a,y(a))},y=async(a=1,e=7,s=v.value,c=f.value,o=_.value)=>{try{if(h.value===null){g.add({title:"Gagal mengambil data",description:"Kredensial tidak ditemukan.",color:"error"});return}const u=await $fetch(`${$}/v2/schedules/paginated`,{params:{page:a,page_size:e,start_date:s,end_date:c,search:o,include_morning:w.value,include_afternoon:x.value,include_night:b.value},headers:{Authorization:h.value}});if(!u.success)throw M({statusCode:400,statusMessage:u.message});E.value=u.data.schedules,i.value=u.data.meta,d.value=u.data.meta.page}catch(u){let V="Unknown Error";u instanceof Error&&(V=u.message),console.error(V),E.value=[],i.value={has_next:!1,has_prev:!1,page:1,page_size:7,total_count:0,total_pages:1},d.value=1}},T=a=>new Date(a).toLocaleDateString("en-US",{dateStyle:"medium"}),B=ie((a=1,e=7,s=v.value,c=f.value,o=_.value)=>{y(a,e,s,c,o)},500),K=()=>{S.value&&S.value.click()},R=async()=>{try{if(h.value===null){g.add({title:"Gagal mengambil data",description:"Kredensial tidak ditemukan.",color:"error"});return}const a=await $fetch(`${$}/v2/schedules`,{params:{start_date:v.value,end_date:f.value,search:_.value,include_morning:w.value,include_afternoon:x.value,include_night:b.value},headers:{Authorization:h.value}});if(!a.success)throw M({statusCode:400,statusMessage:a.message});const e=a.data.map(o=>(new Date(o.scheduled_at).toLocaleString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0}),{"Badge Number":o.identification_number.slice(4),Personel:o.name,"Scheduled At":new Date(o.scheduled_at),Shift:o.shift})),s=L.json_to_sheet(e),c=L.book_new();L.book_append_sheet(c,s),pe(c,"schedules.xlsx",{compression:!0})}catch(a){let e="Unknown Error";a instanceof Error&&(e=a.message),console.error(e)}},O=async a=>{var c;const e=(c=a.target.files)==null?void 0:c[0];if(!e){g.add({title:"No file selected.",color:"error"});return}const s=new FormData;s.append("file",e);try{if(h.value===null)throw g.add({title:"Gagal mengimpor data",description:"Kredensial tidak ditemukan.",color:"error"}),M({statusCode:401,statusMessage:"Kredensial tidak ditemukan, silahkan login kembali"});const o=await $fetch(`${$}/v2/schedules/import`,{method:"POST",headers:{Authorization:h.value},body:s});if(!o.success)throw M({statusCode:400,statusMessage:o.message});g.add({title:o.message,color:"success"}),S.value=null,d.value=1,y(1)}catch(o){let u="Unknown Error";o instanceof Error&&(u=o.message),console.error(u),S.value=null}},J=async a=>{if(confirm("Apakah Anda yakin ingin menghapus jadwal?"))try{if(h.value===null){g.add({title:"Gagal menghapus data",description:"Kredensial tidak ditemukan.",color:"error"});return}const e=await $fetch(`${$}/v2/schedules/${a}`,{method:"DELETE",headers:{Authorization:h.value}});if(!e.success)throw M({statusCode:400,statusMessage:e.message});g.add({title:e.message,color:"success"}),y(d.value)}catch(e){let s="Unknown Error";e instanceof Error&&(s=e.message),g.add({title:s,color:"error"})}},Q=()=>{v.value="",f.value="",_.value="",d.value=1,w.value=!0,x.value=!0,b.value=!0,y(1)};return ee(async()=>{h.value=await F.basicAuth(),y()}),N(d,a=>{B(a,i.value.page_size,v.value,f.value,_.value)}),N([v,f,_],()=>{d.value=1,B(1,i.value.page_size,v.value,f.value,_.value)}),N([w,x,b],()=>{d.value=1,B()}),(a,e)=>{const s=ae,c=se,o=de,u=ce,V=me,q=ve;return z(),A("div",fe,[t("div",_e,[e[9]||(e[9]=t("h1",{class:"text-2xl font-bold"},"Jadwal Shift",-1)),t("div",he,[r(c,{to:"/rosters/create"},{default:p(()=>[r(s,{class:"cursor-pointer",color:"primary"},{default:p(()=>e[6]||(e[6]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 20 20"},[t("path",{fill:"currentColor",d:"M10 2.5a.5.5 0 0 1 .5.5v6.5H17a.5.5 0 0 1 0 1h-6.5V17a.5.5 0 0 1-1 0v-6.5H3a.5.5 0 0 1 0-1h6.5V3a.5.5 0 0 1 .5-.5"})],-1),k(" Create New ")])),_:1,__:[6]})]),_:1}),r(s,{class:"cursor-pointer",color:"secondary",onClick:K},{default:p(()=>e[7]||(e[7]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 20 20"},[t("path",{fill:"currentColor",d:"M17.5 4a.5.5 0 0 1 .5.5v11a.5.5 0 0 1-1 0v-11a.5.5 0 0 1 .5-.5M2 10a.5.5 0 0 1 .5-.5h10.793l-3.147-3.146a.5.5 0 0 1 .708-.708l4 4a.5.5 0 0 1 .146.351v.006c0 .127-.05.254-.146.35l-4 4a.5.5 0 0 1-.708-.707l3.147-3.146H2.5A.5.5 0 0 1 2 10"})],-1),k(" Import ")])),_:1,__:[7]}),r(s,{class:"cursor-pointer",color:"success",onClick:R},{default:p(()=>e[8]||(e[8]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 20 20"},[t("path",{fill:"currentColor",d:"M2.5 4a.5.5 0 0 1 .5.5v11a.5.5 0 0 1-1 0v-11a.5.5 0 0 1 .5-.5M5 10a.5.5 0 0 1 .5-.5h10.793l-3.147-3.146a.5.5 0 0 1 .708-.708l4 4a.5.5 0 0 1 0 .708l-4 4a.5.5 0 0 1-.708-.707l3.147-3.147H5.5A.5.5 0 0 1 5 10"})],-1),k(" Export ")])),_:1,__:[8]}),t("input",{ref_key:"fileInput",ref:S,type:"file",accept:".csv, .xlsx",style:{display:"none"},onChange:O},null,544)])]),t("div",ge,[t("div",we,[t("div",xe,[t("div",be,[e[10]||(e[10]=t("label",{for:"start-date",class:"text-sm font-medium mb-1"},"Start Date",-1)),r(o,{id:"start-date",modelValue:l(v),"onUpdate:modelValue":e[0]||(e[0]=n=>D(v)?v.value=n:null),type:"date",placeholder:"Start Date"},null,8,["modelValue"])]),t("div",ke,[e[11]||(e[11]=t("label",{for:"end-date",class:"text-sm font-medium mb-1"},"End Date",-1)),r(o,{id:"end-date",modelValue:l(f),"onUpdate:modelValue":e[1]||(e[1]=n=>D(f)?f.value=n:null),type:"date",placeholder:"End Date"},null,8,["modelValue"])])]),t("div",ye,[e[12]||(e[12]=t("label",{for:"search",class:"text-sm font-medium mb-1"},"Search",-1)),r(o,{id:"search",modelValue:l(_),"onUpdate:modelValue":e[2]||(e[2]=n=>D(_)?_.value=n:null),placeholder:"Search by name or ID...",icon:"i-heroicons-magnifying-glass"},null,8,["modelValue"])]),t("div",Ce,[r(s,{class:"cursor-pointer",label:"Pagi",variant:l(w)?"solid":"soft",onClick:H},null,8,["variant"]),r(s,{class:"cursor-pointer",label:"Sore",variant:l(x)?"solid":"soft",onClick:I},null,8,["variant"]),r(s,{class:"cursor-pointer",label:"Malam",variant:l(b)?"solid":"soft",onClick:P},null,8,["variant"])])]),t("div",Se,[r(s,{class:"cursor-pointer",variant:"link",onClick:Q},{default:p(()=>e[13]||(e[13]=[k(" Clear Filters ")])),_:1,__:[13]})])]),r(q,{variant:"soft"},te({header:p(()=>[e[14]||(e[14]=t("h2",{class:"text-lg font-semibold"},"List",-1))]),default:p(()=>[l(E).length>0?(z(),A("div",Ae,[t("table",De,[e[17]||(e[17]=t("thead",null,[t("tr",{class:""},[t("th",{class:"p-2"},"Badge Number"),t("th",{class:"p-2"},"Name"),t("th",{class:"p-2"},"Date"),t("th",{class:"p-2"},"Type"),t("th",{class:"p-2"},"Actions")])],-1)),t("tbody",null,[(z(!0),A(ne,null,re(l(E),(n,Pe)=>(z(),A("tr",{key:n.id},[t("td",Me,C(n.identification_number),1),t("td",ze,C(n.name),1),t("td",Ue,C(T(n.scheduled_at)),1),t("td",Ee,[r(u,{color:"info",size:"sm",variant:"subtle",label:n.shift.toUpperCase()},null,8,["label"])]),t("td",$e,[r(c,{to:`/rosters/edit/${n.id}`},{default:p(()=>[r(s,{class:"cursor-pointer",size:"sm",color:"secondary",variant:"soft"},{default:p(()=>e[15]||(e[15]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 20 20"},[t("path",{fill:"currentColor",d:"M17.181 2.927a2.975 2.975 0 0 0-4.259-.054l-9.375 9.375a2.44 2.44 0 0 0-.656 1.194l-.877 3.95a.5.5 0 0 0 .596.597l3.927-.873a2.5 2.5 0 0 0 1.234-.678l9.358-9.358a2.975 2.975 0 0 0 .052-4.153m-3.552.653a1.975 1.975 0 1 1 2.793 2.793l-.671.671l-2.793-2.792zm-1.378 1.38l2.793 2.792l-7.98 7.98a1.5 1.5 0 0 1-.744.409l-3.16.702l.708-3.183c.059-.267.193-.511.386-.704z"})],-1),k(" Update ")])),_:1,__:[15]})]),_:2},1032,["to"]),r(s,{class:"cursor-pointer",size:"sm",color:"error",variant:"solid",onClick:Ge=>J(n.id)},{default:p(()=>e[16]||(e[16]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 20 20"},[t("path",{fill:"currentColor",d:"M8.5 4h3a1.5 1.5 0 0 0-3 0m-1 0a2.5 2.5 0 0 1 5 0h5a.5.5 0 0 1 0 1h-1.054l-1.194 10.344A3 3 0 0 1 12.272 18H7.728a3 3 0 0 1-2.98-2.656L3.554 5H2.5a.5.5 0 0 1 0-1zM5.741 15.23A2 2 0 0 0 7.728 17h4.544a2 2 0 0 0 1.987-1.77L15.439 5H4.561zM8.5 7.5A.5.5 0 0 1 9 8v6a.5.5 0 0 1-1 0V8a.5.5 0 0 1 .5-.5M12 8a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0z"})],-1),k(" Delete ")])),_:2,__:[16]},1032,["onClick"])])]))),128))])])])):(z(),A("div",Ve,"No schedules found"))]),_:2},[l(i).total_count>0?{name:"footer",fn:p(()=>[t("div",Be,[t("span",Ne," Showing "+C((l(i).page-1)*l(i).page_size+1)+" to "+C(Math.min(l(i).page*l(i).page_size,l(i).total_count))+" of "+C(l(i).total_count)+" entries ",1),t("div",Le,[r(V,{page:l(d),"onUpdate:page":e[3]||(e[3]=n=>D(d)?d.value=n:null),"show-controls":!1,"show-edges":"","sibling-count":1,"items-per-page":l(i).page_size,total:l(i).total_count,variant:"subtle"},null,8,["page","items-per-page","total"]),t("div",Fe,[e[19]||(e[19]=t("label",{for:"jump-page",class:"text-sm"},"Go to:",-1)),le(t("input",{id:"jump-page",type:"number","onUpdate:modelValue":e[4]||(e[4]=n=>D(U)?U.value=n:null),min:1,max:l(i).total_pages,class:"w-16 p-1 border rounded"},null,8,je),[[oe,l(U),void 0,{number:!0}]]),r(s,{class:"cursor-pointer",size:"sm",color:"primary",onClick:e[5]||(e[5]=n=>G(l(U)))},{default:p(()=>e[18]||(e[18]=[k("Go")])),_:1,__:[18]})])])])]),key:"0"}:void 0]),1024)])}}}),Qe=ue(He,[["__scopeId","data-v-0585bc5e"]]);export{Qe as default};
