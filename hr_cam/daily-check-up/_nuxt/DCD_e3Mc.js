import{_ as B,a as M}from"./BQDvqDWp.js";import{_ as N}from"./IwDavgve.js";import{f as z,a9 as D,q as s,C as K,D as P,E as R,l as G,J as L,K as j,c as J,a as i,b as c,t as q,w as H,M as b,e as F,o as O,H as Q,I as W}from"./Di3zuZ4U.js";import"./CdQLuhnR.js";import"./CclMCVb1.js";import"./tEGXdHrr.js";import"./DhyUEKXY.js";import"./BxtVtW52.js";const X={class:"px-0.5 py-2"},Y={class:"flex flex-col gap-2"},Z={class:"flex"},ee={class:"flex gap-1"},ue=z({__name:"[id]",setup(te){const y=D(),k=Number(y.params.id),p=s(),f=s(""),u=s(0),h=s(""),d=s(""),U=s(["pagi","sore","malam"]),C=R(),S=K(),l=P(),v=C.public.API_BASE_URL,o=s(null),_=s(!1),$=t=>{h.value=t.toString()},x=async t=>{try{if(o.value===null){l.add({title:"Gagal mengambil data",description:"Kredensial tidak ditemukan.",color:"error"});return}const e=await $fetch(`${v}/v2/schedules/${t}`,{headers:{Authorization:o.value}});if(!e.success)throw b({statusCode:400,statusMessage:e.message});u.value=e.data.person_id,h.value=e.data.scheduled_at.split("T")[0],d.value=e.data.shift}catch(e){let a="Unknown Error";e instanceof Error&&(a=e.message),console.error(a)}},w=async(t=null)=>{try{if(o.value===null){l.add({title:"Gagal mengambil data",description:"Kredensial tidak ditemukan.",color:"error"});return}const e=await $fetch(`${v}/v2/schedules/contractors`,{params:{search:t},headers:{Authorization:o.value}});if(!e.success)throw b({statusCode:400,statusMessage:e.message});p.value=e.data}catch(e){let a="Unknown Error";e instanceof Error&&(a=e.message),console.error(a),p.value=[]}},E=async(t,e,a,g)=>{try{if(o.value===null){l.add({title:"Gagal mengubah data",description:"Kredensial tidak ditemukan.",color:"error"});return}const r=await $fetch(`${v}/v2/schedules/${t}`,{method:"PUT",body:{person_id:e,scheduled_at:a,shift:g},headers:{"Content-Type":"application/json",Authorization:o.value}});if(!r.success)throw b({statusCode:400,statusMessage:r.message})}catch(r){let m="Unknown Error";r instanceof Error&&(m=r.message),console.error(m)}},A=()=>u.value===0?"Silahkan memilih personil.":d.value?"":"Silahkan memilih shift.",V=async()=>{const t=A();if(t){l.add({title:"Error",description:t,color:"error"});return}try{await E(k,u.value,h.value,d.value),l.add({title:"Sukses",description:"Jadwal personil berhasil diubah.",color:"success"}),W("/rosters/")}catch(e){l.add({title:"Error",description:e.message,color:"error"})}},I=G(()=>p.value?p.value.map(t=>({label:`${t.IdentificationNumber} - ${t.Name}`,id:t.ID})):[]);return L(async()=>{o.value=await S.basicAuth(),w(),x(k)}),j(f,t=>{_.value&&w(t)}),(t,e)=>{const a=M,g=N,r=B,m=Q,T=F;return O(),J("div",X,[e[4]||(e[4]=i("div",{class:"flex justify-between items-center mb-6"},[i("h1",{class:"text-2xl font-bold"},"Edit Shift")],-1)),i("div",Y,[i("div",Z,[c(a,{size:"sm","onUpdate:modelValue":$})]),i("p",null,q(h.value),1),c(g,{modelValue:u.value,"onUpdate:modelValue":e[0]||(e[0]=n=>u.value=n),"search-term":f.value,"onUpdate:searchTerm":e[1]||(e[1]=n=>f.value=n),open:_.value,"onUpdate:open":e[2]||(e[2]=n=>_.value=n),placeholder:"Pilih personil","search-input":{placeholder:"Cari..."},"value-key":"id",items:I.value,class:"w-48"},null,8,["modelValue","search-term","open","items"]),c(r,{modelValue:d.value,"onUpdate:modelValue":e[3]||(e[3]=n=>d.value=n),placeholder:"Pilih shift",items:U.value,class:"w-fit"},null,8,["modelValue","items"]),i("div",ee,[c(T,{to:"/rosters/"},{default:H(()=>[c(m,{class:"cursor-pointer",label:"Cancel",variant:"link"})]),_:1}),c(m,{class:"cursor-pointer",label:"Update",onClick:V})])])])}}});export{ue as default};
